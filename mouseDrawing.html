<!DOCTYPE html>
<html>
    <header>
        <h1>Mousing and Drawing Squares</h1>
    </header>
    <meta charset="utf-8"/>
<head>
    <!-- helper javascript -->
    <script type="text/javascript" src="mouse-utils.js"></script>
    <script src="squareDrawing-utils.js"></script>
    <!-- <script src="simpleSquares.html"></script> -->

    <!-- setup vertex and fragment shaders -->
    <script id="vertex" type="x-shader">
        attribute vec2 aVertexPosition;
        void main() {gl_Position = vec4(aVertexPosition, 0.0, 1.0);}
    </script>
    <script id="fragment" type="x-shader">
        #ifdef GL_ES
        precision highp float;
        #endif
        uniform vec4 uColor;
        void main() {gl_FragColor = uColor;}
    </script>
        
    <!-- javascript of the page -->
    <script type="text/javascript">
        function continuousDrawing(event) {
            if (mouseDown) {
                setSmallSquare(lastMouseX-50,lastMouseY-100, [0.0,0.0,0.0]);
            }
    
        }

        function init() {
            // setup visible canvas, where squares are displayed
            var canvas = document.getElementById("displayedCanvas");
            var gl = canvas.getContext("experimental-webgl");
            gl.viewport(0, 0, canvas.width, canvas.height);
            gl.clearColor(0, 0.2, 0.2, 0.2); // baby blue 
            gl.clear(gl.COLOR_BUFFER_BIT);

            // setup shaders
            var v = document.getElementById("vertex").firstChild.nodeValue;
            var f = document.getElementById("fragment").firstChild.nodeValue;
            var vs = gl.createShader(gl.VERTEX_SHADER);
            gl.shaderSource(vs, v);
            gl.compileShader(vs);
            var fs = gl.createShader(gl.FRAGMENT_SHADER);
            gl.shaderSource(fs, f);
            gl.compileShader(fs);
            var program = gl.createProgram();
            gl.attachShader(program, vs);
            gl.attachShader(program, fs);
            gl.linkProgram(program);

            // Catch any errors
            if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS))
                console.log(gl.getShaderInfoLog(vs));
            if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS))
                console.log(gl.getShaderInfoLog(fs));
            if (!gl.getProgramParameter(program, gl.LINK_STATUS))
                console.log(gl.getProgramInfoLog(program));

            // Listen to Mouse Events via mouse-utils.js
            listenToMouse(canvas);

            // Draw Squares with lastMouseX and lastMouseY via mouse-utils.js
            setSmallSquare(0,0,[300,0.0,0.0]);
            setSmallSquare(790,0,[0.0,300,0.0]);
            setSmallSquare(0,490,[0,0.0,300]);
            setSmallSquare(790,490,[300,0.0,300]);
            // Send coordinates to setSmallSquare via squareDrawing-utils.js
            // canvas.onmousedown = continuousDrawing;
            // document.onmousemove = continuousDrawing;

            var nIntervId;
            nIntervId = setInterval(continuousDrawing, 0);

        }
        

    </script>


</head>



<body onload="setupSquareMakingCanvas();init();">
<!--     <canvas id="displayedCanvas" width="800" height="500"></canvas>
    <canvas id="squaremakingcanvas" width="800" height="500"></canvas> -->
    <canvas id="squaremakingcanvas" 
        style="z-index: 1;
        position:absolute;
        left:50px;
        top:100px;
        "
        width="800" height="500">
    </canvas>
    <canvas id="displayedCanvas" style="z-index: 1;
        position:absolute;
        left:50px;
        top:100px;
        " width="800" height="500">
    </canvas>


</body>
</html>